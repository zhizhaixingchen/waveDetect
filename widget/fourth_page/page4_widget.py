# Form implementation generated from reading ui file 'page4_widget.ui'
#
# Created by: PyQt6 UI code generator 6.4.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.
import cv2
from PyQt6 import QtCore, QtGui, QtWidgets
from PyQt6.QtGui import QImage, QPixmap
from PyQt6.QtWidgets import QMessageBox

from diy_widget.D_MyQLabel import Icon_QLabel
from diy_widget.D_CustomSlider import CustomSlider

class Ui_fourth_page(QtWidgets.QWidget):
    handle_img_signal = QtCore.pyqtSignal(list)
    left_bn_signal = QtCore.pyqtSignal(list)
    video_bn_signal = QtCore.pyqtSignal(list)
    def __init__(self,parent,fourth_page,root_file):
        super(Ui_fourth_page,self).__init__()
        self.parent = parent
        self.fourth_page = fourth_page
        self.root_file = root_file
        self.setupUi()
        self.retranslateUi()
        self.connect_action()
        # 获取第一帧
        self.get_first_frame()

    def setupUi(self):
        self.fourth_page.setObjectName("fourth_page")
        self.fourth_page.resize(1200, 800)
        self.widget = QtWidgets.QWidget(parent=self.fourth_page)
        self.widget.setGeometry(QtCore.QRect(10, 20, 1180, 700))
        self.widget.setObjectName("widget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.widget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_4.setSpacing(10)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.reset_bn = Icon_QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.reset_bn.sizePolicy().hasHeightForWidth())
        self.reset_bn.setSizePolicy(sizePolicy)
        self.reset_bn.setMaximumSize(QtCore.QSize(64, 64))
        self.reset_bn.setText("")
        self.reset_bn.setPixmap(QtGui.QPixmap(f"{self.root_file}static/img/reset_btn.png"))
        self.reset_bn.setScaledContents(True)
        self.reset_bn.setObjectName("reset_bn")
        self.horizontalLayout_4.addWidget(self.reset_bn)
        self.module1 = QtWidgets.QGridLayout()
        self.module1.setObjectName("module1")
        self.m1_22 = QtWidgets.QHBoxLayout()
        self.m1_22.setObjectName("m1_22")
        self.contrast_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.contrast_label.sizePolicy().hasHeightForWidth())
        self.contrast_label.setSizePolicy(sizePolicy)
        self.contrast_label.setObjectName("contrast_label")
        self.m1_22.addWidget(self.contrast_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.contrast_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.contrast_slider.sizePolicy().hasHeightForWidth())
        self.contrast_slider.setSizePolicy(sizePolicy)
        self.contrast_slider.setMaximum(100)
        self.contrast_slider.setProperty("value", 50)
        self.contrast_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.contrast_slider.setObjectName("contrast_slider")
        self.m1_22.addWidget(self.contrast_slider)
        self.contrast_per = QtWidgets.QLabel(parent=self.widget)
        self.contrast_per.setObjectName("contrast_per")
        self.m1_22.addWidget(self.contrast_per)
        self.module1.addLayout(self.m1_22, 1, 1, 1, 1)
        self.decolor = QtWidgets.QCheckBox(parent=self.widget)
        self.decolor.setObjectName("decolor")
        self.module1.addWidget(self.decolor, 3, 2, 1, 1)
        self.m1_33 = QtWidgets.QHBoxLayout()
        self.m1_33.setObjectName("m1_33")
        self.hue_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.hue_label.sizePolicy().hasHeightForWidth())
        self.hue_label.setSizePolicy(sizePolicy)
        self.hue_label.setObjectName("hue_label")
        self.m1_33.addWidget(self.hue_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.hue_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.hue_slider.sizePolicy().hasHeightForWidth())
        self.hue_slider.setSizePolicy(sizePolicy)
        self.hue_slider.setMaximum(100)
        self.hue_slider.setProperty("value", 50)
        self.hue_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.hue_slider.setObjectName("hue_slider")
        self.m1_33.addWidget(self.hue_slider)
        self.hue_per = QtWidgets.QLabel(parent=self.widget)
        self.hue_per.setObjectName("hue_per")
        self.m1_33.addWidget(self.hue_per)
        self.module1.addLayout(self.m1_33, 2, 2, 1, 1)
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.m1_41 = QtWidgets.QLabel(parent=self.widget)
        self.m1_41.setObjectName("m1_41")
        self.horizontalLayout.addWidget(self.m1_41, 0, QtCore.Qt.AlignmentFlag.AlignRight)
        self.denoise_combobox = QtWidgets.QComboBox(parent=self.widget)
        self.denoise_combobox.setMaximumSize(QtCore.QSize(150, 16777215))
        self.denoise_combobox.setObjectName("denoise_combobox")
        self.horizontalLayout.addWidget(self.denoise_combobox)
        self.horizontalLayout.setStretch(0, 3)
        self.horizontalLayout.setStretch(1, 7)
        self.module1.addLayout(self.horizontalLayout, 3, 0, 1, 1)
        self.m1_23 = QtWidgets.QHBoxLayout()
        self.m1_23.setObjectName("m1_23")
        self.saturation_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.saturation_label.sizePolicy().hasHeightForWidth())
        self.saturation_label.setSizePolicy(sizePolicy)
        self.saturation_label.setObjectName("saturation_label")
        self.m1_23.addWidget(self.saturation_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.saturation_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.saturation_slider.sizePolicy().hasHeightForWidth())
        self.saturation_slider.setSizePolicy(sizePolicy)
        self.saturation_slider.setMaximum(100)
        self.saturation_slider.setProperty("value", 50)
        self.saturation_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.saturation_slider.setObjectName("saturation_slider")
        self.m1_23.addWidget(self.saturation_slider)
        self.saturation_per = QtWidgets.QLabel(parent=self.widget)
        self.saturation_per.setObjectName("saturation_per")
        self.m1_23.addWidget(self.saturation_per)
        self.module1.addLayout(self.m1_23, 1, 2, 1, 1)
        self.m1_11 = QtWidgets.QHBoxLayout()
        self.m1_11.setObjectName("m1_11")
        self.bright_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bright_label.sizePolicy().hasHeightForWidth())
        self.bright_label.setSizePolicy(sizePolicy)
        self.bright_label.setObjectName("bright_label")
        self.m1_11.addWidget(self.bright_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.bright_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bright_slider.sizePolicy().hasHeightForWidth())
        self.bright_slider.setSizePolicy(sizePolicy)
        self.bright_slider.setMaximum(100)
        self.bright_slider.setProperty("value", 50)
        self.bright_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.bright_slider.setTickPosition(QtWidgets.QSlider.TickPosition.NoTicks)
        self.bright_slider.setTickInterval(1)
        self.bright_slider.setObjectName("bright_slider")
        self.m1_11.addWidget(self.bright_slider)
        self.bright_per = QtWidgets.QLabel(parent=self.widget)
        self.bright_per.setObjectName("bright_per")
        self.m1_11.addWidget(self.bright_per)
        self.module1.addLayout(self.m1_11, 0, 0, 1, 1)
        self.m1_31 = QtWidgets.QHBoxLayout()
        self.m1_31.setObjectName("m1_31")
        self.sharpness_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.sharpness_label.sizePolicy().hasHeightForWidth())
        self.sharpness_label.setSizePolicy(sizePolicy)
        self.sharpness_label.setObjectName("sharpness_label")
        self.m1_31.addWidget(self.sharpness_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.sharpness_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.sharpness_slider.sizePolicy().hasHeightForWidth())
        self.sharpness_slider.setSizePolicy(sizePolicy)
        self.sharpness_slider.setMaximum(100)
        self.sharpness_slider.setProperty("value", 0)
        self.sharpness_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.sharpness_slider.setObjectName("sharpness_slider")
        self.m1_31.addWidget(self.sharpness_slider)
        self.sharpness_per = QtWidgets.QLabel(parent=self.widget)
        self.sharpness_per.setObjectName("sharpness_per")
        self.m1_31.addWidget(self.sharpness_per)
        self.module1.addLayout(self.m1_31, 2, 0, 1, 1)
        self.reverse = QtWidgets.QCheckBox(parent=self.widget)
        self.reverse.setObjectName("reverse")
        self.module1.addWidget(self.reverse, 3, 1, 1, 1)
        self.m1_13 = QtWidgets.QHBoxLayout()
        self.m1_13.setObjectName("m1_13")
        self.exposure_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.exposure_label.sizePolicy().hasHeightForWidth())
        self.exposure_label.setSizePolicy(sizePolicy)
        self.exposure_label.setObjectName("exposure_label")
        self.m1_13.addWidget(self.exposure_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.exposure_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.exposure_slider.sizePolicy().hasHeightForWidth())
        self.exposure_slider.setSizePolicy(sizePolicy)
        self.exposure_slider.setMinimum(0)
        self.exposure_slider.setMaximum(100)
        self.exposure_slider.setProperty("value", 50)
        self.exposure_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.exposure_slider.setObjectName("exposure_slider")
        self.m1_13.addWidget(self.exposure_slider)
        self.exposure_per = QtWidgets.QLabel(parent=self.widget)
        self.exposure_per.setObjectName("exposure_per")
        self.m1_13.addWidget(self.exposure_per)
        self.module1.addLayout(self.m1_13, 0, 2, 1, 1)
        self.m1_21 = QtWidgets.QHBoxLayout()
        self.m1_21.setObjectName("m1_21")
        self.highlight_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.highlight_label.sizePolicy().hasHeightForWidth())
        self.highlight_label.setSizePolicy(sizePolicy)
        self.highlight_label.setObjectName("highlight_label")
        self.m1_21.addWidget(self.highlight_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.highlight_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.highlight_slider.sizePolicy().hasHeightForWidth())
        self.highlight_slider.setSizePolicy(sizePolicy)
        self.highlight_slider.setMaximum(100)
        self.highlight_slider.setProperty("value", 50)
        self.highlight_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.highlight_slider.setObjectName("highlight_slider")
        self.m1_21.addWidget(self.highlight_slider)
        self.highlight_per = QtWidgets.QLabel(parent=self.widget)
        self.highlight_per.setObjectName("highlight_per")
        self.m1_21.addWidget(self.highlight_per)
        self.module1.addLayout(self.m1_21, 1, 0, 1, 1)
        self.m1_12 = QtWidgets.QHBoxLayout()
        self.m1_12.setObjectName("m1_12")
        self.clarity_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.clarity_label.sizePolicy().hasHeightForWidth())
        self.clarity_label.setSizePolicy(sizePolicy)
        self.clarity_label.setObjectName("clarity_label")
        self.m1_12.addWidget(self.clarity_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.clarity_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.clarity_slider.sizePolicy().hasHeightForWidth())
        self.clarity_slider.setSizePolicy(sizePolicy)
        self.clarity_slider.setMaximum(100)
        self.clarity_slider.setProperty("value", 0)
        self.clarity_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.clarity_slider.setObjectName("clarity_slider")
        self.m1_12.addWidget(self.clarity_slider)
        self.clarity_per = QtWidgets.QLabel(parent=self.widget)
        self.clarity_per.setObjectName("clarity_per")
        self.m1_12.addWidget(self.clarity_per)
        self.module1.addLayout(self.m1_12, 0, 1, 1, 1)
        self.m1_32 = QtWidgets.QHBoxLayout()
        self.m1_32.setObjectName("m1_32")
        self.temperature_label = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.temperature_label.sizePolicy().hasHeightForWidth())
        self.temperature_label.setSizePolicy(sizePolicy)
        self.temperature_label.setObjectName("temperature_label")
        self.m1_32.addWidget(self.temperature_label, 0, QtCore.Qt.AlignmentFlag.AlignLeft)
        self.temperature_slider = QtWidgets.QSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.temperature_slider.sizePolicy().hasHeightForWidth())
        self.temperature_slider.setSizePolicy(sizePolicy)
        self.temperature_slider.setMaximum(100)
        self.temperature_slider.setProperty("value", 50)
        self.temperature_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.temperature_slider.setObjectName("temperature_slider")
        self.m1_32.addWidget(self.temperature_slider)
        self.temperature_per = QtWidgets.QLabel(parent=self.widget)
        self.temperature_per.setObjectName("temperature_per")
        self.m1_32.addWidget(self.temperature_per)
        self.module1.addLayout(self.m1_32, 2, 1, 1, 1)
        self.horizontalLayout_4.addLayout(self.module1)
        self.horizontalLayout_4.setStretch(0, 1)
        self.horizontalLayout_4.setStretch(1, 9)
        self.verticalLayout.addLayout(self.horizontalLayout_4)
        self.line = QtWidgets.QFrame(parent=self.widget)
        self.line.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line.setObjectName("line")
        self.verticalLayout.addWidget(self.line)
        self.module2 = QtWidgets.QHBoxLayout()
        self.module2.setObjectName("module2")
        self.module2_1 = QtWidgets.QVBoxLayout()
        self.module2_1.setObjectName("module2_1")
        self.bn_import = QtWidgets.QPushButton(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bn_import.sizePolicy().hasHeightForWidth())
        self.bn_import.setSizePolicy(sizePolicy)
        self.bn_import.setCursor(QtGui.QCursor(QtCore.Qt.CursorShape.PointingHandCursor))
        self.bn_import.setObjectName("bn_import")
        self.module2_1.addWidget(self.bn_import, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.bn_export = QtWidgets.QPushButton(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bn_export.sizePolicy().hasHeightForWidth())
        self.bn_export.setSizePolicy(sizePolicy)
        self.bn_export.setObjectName("bn_export")
        self.module2_1.addWidget(self.bn_export, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.bn_search = QtWidgets.QPushButton(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bn_search.sizePolicy().hasHeightForWidth())
        self.bn_search.setSizePolicy(sizePolicy)
        self.bn_search.setObjectName("bn_search")
        self.module2_1.addWidget(self.bn_search, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.bn_show = QtWidgets.QPushButton(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bn_show.sizePolicy().hasHeightForWidth())
        self.bn_show.setSizePolicy(sizePolicy)
        self.bn_show.setObjectName("bn_show")
        self.module2_1.addWidget(self.bn_show, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.bn_save = QtWidgets.QPushButton(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bn_save.sizePolicy().hasHeightForWidth())
        self.bn_save.setSizePolicy(sizePolicy)
        self.bn_save.setObjectName("bn_save")
        self.module2_1.addWidget(self.bn_save, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.bn_predict = QtWidgets.QPushButton(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Fixed, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bn_predict.sizePolicy().hasHeightForWidth())
        self.bn_predict.setSizePolicy(sizePolicy)
        self.bn_predict.setObjectName("bn_predict")
        self.module2_1.addWidget(self.bn_predict, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.module2.addLayout(self.module2_1)
        self.main_img = QtWidgets.QLabel(parent=self.widget)
        self.main_img.setText("")
        self.main_img.setPixmap(QtGui.QPixmap(self.root_file+"tmp/tmp.jpg"))
        self.main_img.setScaledContents(True)
        self.main_img.setObjectName("main_img")
        self.module2.addWidget(self.main_img, 0, QtCore.Qt.AlignmentFlag.AlignHCenter)
        self.module2.setStretch(1, 9)
        self.verticalLayout.addLayout(self.module2)
        self.module3 = QtWidgets.QHBoxLayout()
        self.module3.setContentsMargins(75, -1, -1, -1)
        self.module3.setObjectName("module3")
        self.cur_file = QtWidgets.QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.cur_file.sizePolicy().hasHeightForWidth())
        self.cur_file.setSizePolicy(sizePolicy)
        self.cur_file.setObjectName("cur_file")
        self.module3.addWidget(self.cur_file)
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.mode_label = QtWidgets.QLabel(parent=self.widget)
        self.mode_label.setObjectName("model_label")
        self.horizontalLayout_2.addWidget(self.mode_label, 0, QtCore.Qt.AlignmentFlag.AlignRight)
        self.mode_combobox = QtWidgets.QComboBox(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.mode_combobox.sizePolicy().hasHeightForWidth())
        self.mode_combobox.setSizePolicy(sizePolicy)
        self.mode_combobox.setObjectName("mode_combobox")
        self.horizontalLayout_2.addWidget(self.mode_combobox)
        self.horizontalLayout_2.setStretch(0, 3)
        self.horizontalLayout_2.setStretch(1, 7)
        self.module3.addLayout(self.horizontalLayout_2)
        self.module3.setStretch(0, 8)
        self.module3.setStretch(1, 2)
        self.verticalLayout.addLayout(self.module3)
        self.line_2 = QtWidgets.QFrame(parent=self.widget)
        self.line_2.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.line_2.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_2.setObjectName("line_2")
        self.verticalLayout.addWidget(self.line_2)
        self.module4 = QtWidgets.QHBoxLayout()
        self.module4.setContentsMargins(75, -1, -1, -1)
        self.module4.setObjectName("module4")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.video_slider = CustomSlider(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.video_slider.sizePolicy().hasHeightForWidth())
        self.video_slider.setSizePolicy(sizePolicy)
        self.video_slider.setMinimum(0)
        self.video_slider.setMaximum(100)
        self.video_slider.setMaximumSize(QtCore.QSize(16777215, 16777215))
        self.video_slider.setOrientation(QtCore.Qt.Orientation.Horizontal)
        self.video_slider.setObjectName("video_slider")
        # self.video_slider.setSliderDown(False)

        self.horizontalLayout_3.addWidget(self.video_slider)
        self.video_time = QtWidgets.QLabel(parent=self.widget)
        self.video_time.setObjectName("video_time")
        self.horizontalLayout_3.addWidget(self.video_time)
        self.horizontalLayout_3.setStretch(0, 9)
        self.horizontalLayout_3.setStretch(1, 1)
        self.module4.addLayout(self.horizontalLayout_3)
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.pre_btn = Icon_QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pre_btn.sizePolicy().hasHeightForWidth())
        self.pre_btn.setSizePolicy(sizePolicy)
        self.pre_btn.setMaximumSize(QtCore.QSize(60, 60))
        self.pre_btn.setText("")
        self.pre_btn.setPixmap(QtGui.QPixmap(f"{self.root_file}static/img/video_back.png"))
        self.pre_btn.setScaledContents(True)
        self.pre_btn.setObjectName("pre_btn")
        self.horizontalLayout_5.addWidget(self.pre_btn)
        self.play_pause_btn = Icon_QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.play_pause_btn.sizePolicy().hasHeightForWidth())
        self.play_pause_btn.setSizePolicy(sizePolicy)
        self.play_pause_btn.setMaximumSize(QtCore.QSize(64, 64))
        self.play_pause_btn.name = 'play'
        self.play_pause_btn.setPixmap(QtGui.QPixmap(f"{self.root_file}static/img/video_play.png"))
        self.play_pause_btn.setScaledContents(True)
        self.play_pause_btn.setObjectName("play_pause_btn")
        self.horizontalLayout_5.addWidget(self.play_pause_btn)
        self.next_btn = Icon_QLabel(parent=self.widget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.next_btn.sizePolicy().hasHeightForWidth())
        self.next_btn.setSizePolicy(sizePolicy)
        self.next_btn.setMaximumSize(QtCore.QSize(60, 60))
        self.next_btn.setText("")
        self.next_btn.setPixmap(QtGui.QPixmap(f"{self.root_file}static/img/video_forward.png"))
        self.next_btn.setScaledContents(True)
        self.next_btn.setObjectName("next_btn")
        self.horizontalLayout_5.addWidget(self.next_btn)
        self.module4.addLayout(self.horizontalLayout_5)
        self.verticalLayout.addLayout(self.module4)
        self.verticalLayout.setStretch(0, 3)
        self.verticalLayout.setStretch(2, 9)
        self.verticalLayout.setStretch(3, 1)
        self.verticalLayout.setStretch(5, 1)

        QtCore.QMetaObject.connectSlotsByName(self.fourth_page)

    def retranslateUi(self):
        _translate = QtCore.QCoreApplication.translate
        self.fourth_page.setWindowTitle(_translate("fourth_page", "Form"))
        self.contrast_label.setText(_translate("fourth_page", "对比度："))
        self.contrast_per.setText(_translate("fourth_page", "50%  "))
        self.decolor.setText(_translate("fourth_page", "去色"))
        self.hue_label.setText(_translate("fourth_page", "色   调："))
        self.hue_per.setText(_translate("fourth_page", "50%  "))
        self.m1_41.setText(_translate("fourth_page", "去噪："))
        self.denoise_combobox.addItem("选择去噪算法")
        self.denoise_combobox.addItem("锐化滤波")
        self.denoise_combobox.addItem("模糊滤波")
        self.denoise_combobox.addItem("轮廓滤波")
        self.denoise_combobox.addItem("浮雕滤波")
        self.denoise_combobox.addItem("细节增强滤波")
        self.denoise_combobox.addItem("边缘增强滤波")
        self.denoise_combobox.addItem("深度边缘增强滤波")
        self.denoise_combobox.addItem("寻找边缘信息滤波")
        self.denoise_combobox.addItem("平滑滤波")
        self.denoise_combobox.addItem("深度平滑滤波")
        self.saturation_label.setText(_translate("fourth_page", "饱和度："))
        self.saturation_per.setText(_translate("fourth_page", "50%  "))
        self.bright_label.setText(_translate("fourth_page", "鲜明度："))
        self.bright_per.setText(_translate("fourth_page", "50%  "))
        self.sharpness_label.setText(_translate("fourth_page", "锐   化："))
        self.sharpness_per.setText(_translate("fourth_page", "0%  "))
        self.reverse.setText(_translate("fourth_page", "反向"))
        self.exposure_label.setText(_translate("fourth_page", "曝光度："))
        self.exposure_per.setText(_translate("fourth_page", "50%  "))
        self.highlight_label.setText(_translate("fourth_page", "高光度："))
        self.highlight_per.setText(_translate("fourth_page", "50%  "))
        self.clarity_label.setText(_translate("fourth_page", "清晰度："))
        self.clarity_per.setText(_translate("fourth_page", "0%  "))
        self.temperature_label.setText(_translate("fourth_page", "色   温："))
        self.temperature_per.setText(_translate("fourth_page", "50%  "))
        self.bn_import.setText(_translate("fourth_page", "文件导入"))
        self.bn_export.setText(_translate("fourth_page", "文件导出"))
        self.bn_search.setText(_translate("fourth_page", "文件检索"))
        self.bn_show.setText(_translate("fourth_page", "数据显示"))
        self.bn_save.setText(_translate("fourth_page", "图像存储"))
        self.bn_predict.setText(_translate("fourth_page", "结果预测"))
        self.video_time.setText(_translate("fourth_page", "0:00/0:00"))
        self.cur_file.setText(_translate("fourth_page", f"选中文件：{self.root_file}resources/default_video.mp4"))
        self.mode_label.setText(_translate("fourth_page", "模式："))
        self.mode_combobox.addItem("视频流")
        self.mode_combobox.addItem("图片帧")

    def connect_action(self):
        # 图片信息调整
        self.bright_slider.valueChanged.connect(lambda x: self.handle_img_action("bright"))
        self.clarity_slider.valueChanged.connect(lambda x: self.handle_img_action("clarity"))
        self.exposure_slider.valueChanged.connect(lambda x: self.handle_img_action("exposure"))
        self.highlight_slider.valueChanged.connect(lambda x: self.handle_img_action("highlight"))
        self.contrast_slider.valueChanged.connect(lambda x: self.handle_img_action("contrast"))
        self.saturation_slider.valueChanged.connect(lambda x: self.handle_img_action("saturation"))
        self.sharpness_slider.valueChanged.connect(lambda x: self.handle_img_action("sharpness"))
        self.temperature_slider.valueChanged.connect(lambda x: self.handle_img_action("temperature"))
        self.hue_slider.valueChanged.connect(lambda x: self.handle_img_action("hue"))
        self.denoise_combobox.currentIndexChanged.connect(lambda x: self.handle_img_action("denoise"))
        self.decolor.stateChanged.connect(lambda x: self.handle_img_action("decolor"))
        self.reverse.stateChanged.connect(lambda x: self.handle_img_action("reverse"))
        self.reset_bn.connect_customized_slot(self.reset_png)
        # 左侧按钮
        self.bn_import.clicked.connect(lambda x: self.left_button_action("import"))
        self.bn_export.clicked.connect(lambda x: self.left_button_action("export"))
        self.bn_search.clicked.connect(lambda x: self.left_button_action("search"))
        self.bn_show.clicked.connect(lambda x: self.left_button_action("show"))
        self.bn_save.clicked.connect(lambda x: self.left_button_action("save"))
        self.bn_predict.clicked.connect(lambda x: self.left_button_action("predict"))
        # 视频播放
        # self.video_slider.sliderPressed.connect(self.video_slider_press_action)
        # self.video_slider.sliderReleased.connect(self.video_slider_release_action)
        self.video_slider.customPress.connect(self.video_slider_press_action)
        self.video_slider.customRelease.connect(self.video_slider_release_action)
        self.play_pause_btn.connect_customized_slot(self.video_button_action)
        # pre_btn 与 next_btn 功能暂时设定为快进几秒或快退5秒，5是超参数可以调节
        self.pre_btn.connect_customized_slot(self.video_button_action)
        self.next_btn.connect_customized_slot(self.video_button_action)
        # 模式切换
        self.mode_combobox.currentIndexChanged.connect(self.mode_action)

    def reset_png(self):
        self.reset_bn.setStyleSheet("")
        self.main_img.setPixmap(QtGui.QPixmap(self.root_file+"tmp/tmp.jpg"))
        self.bright_slider.setProperty("value", 50)
        self.clarity_slider.setProperty("value", 0)
        self.exposure_slider.setProperty("value", 50)
        self.highlight_slider.setProperty("value", 50)
        self.contrast_slider.setProperty("value", 50)
        self.saturation_slider.setProperty("value", 50)
        self.sharpness_slider.setProperty("value", 0)
        self.temperature_slider.setProperty("value", 50)
        self.hue_slider.setProperty("value", 50)
        self.denoise_combobox.setCurrentText("选择去噪算法")
        self.decolor.setChecked(False)
        self.reverse.setChecked(False)
        self.isModify = False

    def handle_img_action(self, action):
        if action in ['decolor','reverse']:
            self.handle_img_signal.emit([self, action, self.sender().isChecked(), self.cur_file.text().split("选中文件：")[1],self.root_file])
        elif action == 'denoise':
            self.handle_img_signal.emit([self, action, self.sender().currentText(), self.cur_file.text().split("选中文件：")[1],self.root_file])
        else:
            self.handle_img_signal.emit([self, action ,self.sender().value(),self.cur_file.text().split("选中文件：")[1],self.root_file])

    def left_button_action(self,action):
        self.left_bn_signal.emit([self.parent,self,action,self.root_file])

    def video_button_action(self):
        obj_name = self.sender().objectName()
        mode = self.mode_combobox.currentText()
        self.video_bn_signal.emit([self,obj_name,5,mode,self.cur_file.text().split("选中文件：")[1],self.root_file])


    # 按下视频暂停
    def video_slider_press_action(self):
        mode = self.mode_combobox.currentText()
        self.video_bn_signal.emit([self,"slider_press","",mode,self.cur_file.text().split("选中文件：")[1],self.root_file])

    # 松开视频播放(可以将其与def video_button_action()代码合并减少代码冗余)
    def video_slider_release_action(self):
        mode = self.mode_combobox.currentText()
        self.video_bn_signal.emit([self,"slider_release",self.sender().value(),mode,self.cur_file.text().split("选中文件：")[1],self.root_file])

    # 图片帧valueChanged触发
    # def video_slider_value_changed_action(self):
    #     if self.mode_combobox.currentText() == '图片帧':
    #         self.video_bn_signal.emit([self, "slider_value_change", self.sender().value(), "图片帧", self.cur_file.text().split("选中文件：")[1],self.root_file])

    def mode_action(self):
        obj_name = self.sender().objectName()
        mode = self.sender().currentText()
        self.video_bn_signal.emit([self,obj_name,"",mode,self.cur_file.text().split("选中文件：")[1],self.root_file])

    # 获取第一帧
    def get_first_frame(self):
        cap = cv2.VideoCapture(f"{self.root_file}resources/default_video.mp4")
        cap.set(cv2.CAP_PROP_POS_FRAMES, 0)
        ret, frame = cap.read()
        cv2.imwrite(f"{self.root_file}tmp/tmp.jpg", frame)
        qImg = QImage(frame, frame.shape[1], frame.shape[0], QImage.Format.Format_RGB888).rgbSwapped()
        self.main_img.setPixmap(QPixmap.fromImage(qImg))
        cap.release()
